temp$treat <- trt
## attach to empty dataframe
randomized <- rbind(randomized, temp)
}
randomized <- randomized[-1,]
write.csv(randomized, "seed_treatments.csv")
installr::updateR()
library(installr)
install.packages("installr")
installr::updateR()
install.packages(c("ape", "backports", "broom", "carData", "cli", "cpp11", "DBI", "DiagrammeR", "digest", "doParallel", "dplyr", "dtplyr", "emmeans", "fansi", "foreach", "fs", "generics", "glue", "gower", "htmlTable", "httpuv", "igraph", "iterators", "jsonlite", "knitr", "lavaan", "lme4", "magrittr", "multcomp", "nloptr", "openssl", "openxlsx", "parallelly", "permute", "pillar", "progressr", "quantreg", "Rcpp", "RcppArmadillo", "RcppThread", "readr", "rlang", "Rttf2pt1", "scico", "segmented", "stringi", "tidyr", "tinytex", "vroom", "withr", "xml2", "yaml"))
blocks <- c("1", "3", "5", "6", "7", "8", "12", "14", "15", "16")
blocks <- c("3", "5", "6", "7", "8", "12", "14", "15", "16")
control <- c("5","7","8","15","16")
drought <- c("3","4","6","12","14")
sample(control, size = 3)
sample(drought, size = 3)
library(tidyverse)
library(tidyverse)
library(tidyverse)
install.packages("lme4")
install.packages("scico")
install.packages("MuMIN")
install.packages("MuMIn")
?installr
??installr
install.packages("installr")
install.packages("StanHeaders", repos = c("https://mc-stan.org/r-packages/", getOption("repos")))
install.packages("rstan", repos = c("https://mc-stan.org/r-packages/", getOption("repos")))
example(stan_model, package = "rstan", run.dontrun = TRUE)
## use it as a calculator
1 + 1
1*8
2*2
3^3
2/2 ## divide
## creating objects
a <- 1
## after you run this line, you have assigned the value 1 to a and R remembers this
a + 1
a/5
a^8
## can reassign objects
a <- 5
a + 1
str(a)
5 <- 4
## if we need to store a list of total biomass weights
weights <- c(1.5, 0.4, 2.8, 3.3, 2.1, 4.3)
## now that we have a list of numbers
weights2 <- 1.5, 0.4, 2.8, 3.3, 2.1, 4.3
weights
## OR we can use an R function
mean(weights)
## what else could we calculate about these plant weights?
## standard deviation?
sd(weights)
## maximum weight?
max(weights)
## c() is a function that creates a vector from a list of values
## we can learn more about what any particular function does by typing:
?c()
## A little bit more about functions
## there are many functions that come with R, these are called base functions
## functions
mean()
mean(1, 4, 6, 7, 9)
?mean()
mean(1:10)
mean(c(1, 3, 4)) ## why does this one work?
mean(2, 3, 4) ## why doesn't this work?
mean(c(2, 3, 4)) ## why does this one work?
## some arguments are required and some are optional
?mean()
library(ggplot2)
install.packages("rlang")
library(ggplot2)
install.packages("vctrs")
install.packages("vctrs")
install.packages("vctrs")
library(ggplot2)
library(tidyverse)
## load packages
library(tidyverse)
library(lubridate)
library(scico)
library(ggpubr)
library(cowplot)
library(scico)
## read in data
source("finalprep_postcalcs.R")
setwd("C:/Users/carme/Documents/Repositories/klee-stability")
## read in data
source("finalprep_postcalcs.R")
setwd("C:/Users/carme/Documents/Repositories/klee-stability/current_scripts")
## read in data
source("finalprep_postcalcs.R")
## Figure Settings ##
theme_set(theme_classic()) #set the theme
# Figure 2: Cover and Richness over time ####
## get dates correct for plotting
ppt_date <- drought_record %>%
mutate(Date_final = ymd(sample_date)) %>%
filter(drought == 1)
ppt_record <- drought_record %>%
mutate(Date_final = ymd(sample_date))
## calculate mean cover at each time point
meancov <- totcov %>%
mutate(type = "Full") %>%
group_by(TREATMENT, Date_final, type) %>%
summarise(meancov = mean(totcov))
## change treatment to a factor and reorder
meancov$TREATMENT <- as.factor(meancov$TREATMENT)
meancov <- meancov %>%
mutate(TREATMENT = fct_relevel(TREATMENT, "O", "W", "MW", "C", "WC", "MWC"))
## make a vector of all sample dates to use for axis labels
dates <- meancov[['Date_final']]
june <- unique(dates[dates %like% "06-"])
## Graph annual rainfall over time
ppt_plot <- ggplot(ppt_record, aes(x=Date_final, y=preceding12ppt)) +
geom_line(size = 0.75) +
geom_vline(data = ppt_date, mapping = aes(xintercept = Date_final), linetype = "dashed") +
xlab("") + ylab("Rainfall (mm)") +
theme(legend.title = element_text(size=12)) +  theme(text = element_text(size = 12)) +
scale_x_date(breaks = june, labels = NULL)
## Graph total cover over time
tcov_drought <- ggplot(meancov, aes(x=Date_final, y=meancov, color = TREATMENT)) +
geom_vline(data = ppt_date, mapping = aes(xintercept = Date_final), linetype = "dashed") +
geom_line(size = 0.75) +
scale_color_scico_d(palette = "batlow", direction = -1) +
ylab("Total Cover") + xlab("") +
scale_x_date(breaks = june, labels = NULL) +
theme(legend.title = element_text(size=12)) +  theme(text = element_text(size = 12)) +
labs(col = "Treatment")
## Graph richness over time
richtime <- ggplot(meanannrich, aes(x=Date_final, y=meanrich, col=TREATMENT)) +
geom_vline(data = ppt_date, mapping = aes(xintercept = Date_final), linetype = "dashed") +
geom_line(size = 0.75) +
ylab("Richness") + xlab("") +
scale_color_scico_d(palette = "batlow", direction = -1) +
theme(legend.title = element_text(size=12)) +
theme(text = element_text(size = 12)) +
scale_x_date(breaks = june, date_labels = "%Y") +
theme(legend.position = "none") +
labs(col = "Treatment") + #change legend title
theme(axis.text.x = element_text(angle = 45, hjust = 1))
pdf("figure2.pdf", width = 7.087, height = 6.5, onefile = F)
ggarrange(ppt_plot, tcov_drought, richtime, ncol = 1, nrow = 3,
common.legend = TRUE,
legend = "bottom",
labels = "AUTO",
align = "v")
dev.off()
# Figure 3: Stability (full ts, 10yr) ####
s <- ggplot(meanstab_mech, aes(x=TREATMENT, y=mean_st)) +
geom_point(size=3) +
geom_errorbar(aes(ymin = mean_st-SE_st, ymax=mean_st+SE_st), width = 0.2) + #add standard error bars
ylab("Stability (all years)") + xlab("Herbivore Treatment") + #label axes
theme(legend.title = element_text(size=12)) +
theme(text = element_text(size = 12)) +
theme(legend.text = element_text(size=12)) +
geom_point(aes(fill=TREATMENT),
colour="black",pch=21, size=4) +
labs(fill = "Herbivore Treatment") +
scale_fill_scico_d(palette = "batlow", direction = -1)
sdreg <- ggplot(mwfigs10, aes(x=Dscore, y=stability)) +
geom_point() +
ylab("Stability (10 year)") + xlab("Drought Score") +
geom_point(aes(fill=TREATMENT),
colour="black",pch=21, size=2.5) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
scale_color_scico_d(palette = "batlow", direction = -1) +
theme(legend.position = "right") +
geom_line(stat = "smooth", method = "lm", formula = y~x,
size = 1.25) +
theme(legend.text = element_text(size=12)) +
labs(fill = "Treatment:") +
theme(legend.title = element_text(size=12)) +
theme(text = element_text(size = 12))
pdf("figure3.pdf", width = 7.087, height = 3.75, onefile = F)
ggarrange(sdreg, s,
ncol = 2, nrow = 1,
common.legend = TRUE,
legend = "bottom",
align = "hv",
labels = "AUTO")
dev.off()
## modified Fig 3A for Truman ####
ggplot(mwfigs10, aes(x=Dscore, y=stability, color = TREATMENT)) +
geom_point() +
ylab("Stability (10 year)") + xlab("Drought Score") +
geom_point(aes(fill=TREATMENT),
colour="black",pch=21, size=2.5) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
scale_color_scico_d(palette = "batlow", direction = -1) +
theme(legend.position = "right") +
geom_line(stat = "smooth", method = "lm", formula = y~x,
size = 1.25) +
theme(legend.text = element_text(size=12)) +
labs(fill = "Treatment:") +
theme(legend.title = element_text(size=12)) +
theme(text = element_text(size = 12)) +
guides(color = "none")
ggsave("fig3a_modified.pdf", height = 4.5, width = 5.5)
# Figure 4: Top-down and bottom-up effects on biotic stability mechanisms ####
## variance ratio by herbivore treatment
VRtrt <- ggplot(tsVR_plot, aes(x=TREATMENT, y=mean_cVR, fill = TREATMENT, shape = community_type, color = TREATMENT)) +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_errorbar(aes(ymin = mean_cVR-SE_cVR, ymax=mean_cVR+SE_cVR), width = 0.2, color = "black") +
geom_point(size = 3) +
geom_point(size = 3, fill = NA, colour = "black") +
scale_shape_manual(values = c(21,22,18)) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
theme(legend.title = element_text(size=12)) +
theme(text = element_text(size = 12)) +
theme(legend.text = element_text(size=12)) +
xlab("Herbivore Treatment") + ylab("Variance Ratio (all yrs)") +
scale_color_scico_d(palette = "batlow", direction = -1) +
guides(color=guide_legend("Treatment:"), fill = FALSE, shape =guide_legend("Species:")) +
annotate("text", x =5, y=1.08, label = "synchronous", size = 3.5,  fontface = 'italic') +
annotate("text", x =5, y=0.94, label = "asynchronous", size = 3.5, fontface = 'italic')
## population stability by herbivore
pdomspstab <- ggplot(meanstab_mech, aes(x=TREATMENT, y=avgpopstab)) +
geom_errorbar(aes(ymin = avgpopstab-SEpopstab, ymax=avgpopstab+SEpopstab), width = 0.3) +
geom_point(aes(fill=TREATMENT),
colour="black",pch=22, size=3) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
ylab("Population Stability (all yrs)") + xlab("Herbivore Treatment") +
theme(legend.title = element_text(size=12)) +  theme(text = element_text(size = 12))
## richness by herbivore treatment
prich <- ggplot(meanstab_mech, aes(x=TREATMENT , y=mean_rich)) +
geom_errorbar(aes(ymin = mean_rich-SE_rich, ymax=mean_rich+SE_rich), width = 0.3) +
geom_point(aes(fill=TREATMENT),
colour="black",pch=21, size=3) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
ylab("Species Richness (all yrs)") + xlab("Herbivore Treatment") +
theme(legend.title = element_text(size=12)) +  theme(text = element_text(size = 12)) +
labs(col = "Time Period")
## variance ratio (10 year)
vrdreg <- ggplot(mwfigs10, aes(x=Dscore, y=classicVR)) +
geom_point() +
ylab("Variance Ratio (10 yr)") + xlab("Drought Score") +
geom_point(aes(fill=TREATMENT),
colour="black",pch=21, size=2.5, show.legend = FALSE) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
scale_color_scico_d(palette = "batlow", direction = -1) +
theme(legend.position = "right") +
geom_line(stat = "smooth", method = "lm", formula = y~x,
size = 1) +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_line(stat = "smooth", method = "lm", formula = y~x,
size = 1.25) +
theme(legend.title = element_text(size=12)) +  theme(text = element_text(size = 12)) +
annotate("text", x =0.23, y=1.11, label = "synchronous", size = 3.5, fontface = 'italic') +
annotate("text", x =0.23, y=0.92, label = "asynchronous", size = 3.5, fontface = 'italic')
## population stability (10 year)
psdreg <- ggplot(mwfigs10, aes(x=Dscore, y=popstab)) +
geom_point() +
ylab("Population Stability (10 yr)") + xlab("Drought Score") +
geom_point(aes(fill=TREATMENT),
colour="black",pch=22, size=2.5) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
scale_color_scico_d(palette = "batlow", direction = -1) +
theme(legend.position = "right") +
geom_line(stat = "smooth", method = "lm", formula = y~x,
size = 1.25, color = "gray") +
theme(legend.title = element_text(size=12)) +  theme(text = element_text(size = 12))
## richness (10 year)
ridreg <- ggplot(mwfigs10, aes(x=Dscore, y=richness)) +
geom_point() +
ylab("Species Richness (10 yr)") + xlab("Drought Score") +
geom_point(aes(fill=TREATMENT),
colour="black",pch=21, size=2.5) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
scale_color_scico_d(palette = "batlow", direction = -1) +
theme(legend.position = "right") +
geom_line(stat = "smooth", method = "lm", formula = y~x,
size = 1.25) +
theme(legend.title = element_text(size=12)) +  theme(text = element_text(size = 12))
pdf("figure4.pdf", width = 7.087, height = 9, onefile = F)
ggarrange(vrdreg, VRtrt,
psdreg, pdomspstab,
ridreg,prich,
ncol = 2, nrow = 3,
common.legend = TRUE,
legend = "bottom",
align = "hv",
labels = "AUTO",
vjust = 1.1)
dev.off()
## Modified Fig 4A for Truman ####
ggplot(mwfigs10, aes(x=Dscore, y=classicVR, color = TREATMENT)) +
geom_point() +
ylab("Variance Ratio (10 yr)") + xlab("Drought Score") +
geom_point(aes(fill=TREATMENT),
colour="black",pch=21, size=2.5) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
scale_color_scico_d(palette = "batlow", direction = -1) +
theme(legend.position = "right") +
geom_line(stat = "smooth", method = "lm", formula = y~x,
size = 1) +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_line(stat = "smooth", method = "lm", formula = y~x,
size = 1.25) +
theme(legend.title = element_text(size=12)) +  theme(text = element_text(size = 12)) +
annotate("text", x =0.23, y=1.11, label = "synchronous", size = 3.5, fontface = 'italic') +
annotate("text", x =0.23, y=0.92, label = "asynchronous", size = 3.5, fontface = 'italic') +
guides(color = "none")
ggsave("fig4a_modified.pdf", height = 4.5, width = 5.5)
## Modified Fig 4C for Truman ####
ggplot(mwfigs10, aes(x=Dscore, y=popstab, color = TREATMENT)) +
geom_point() +
ylab("Population Stability (10 yr)") + xlab("Drought Score") +
geom_point(aes(fill=TREATMENT),
colour="black",pch=22, size=2.5) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
scale_color_scico_d(palette = "batlow", direction = -1) +
theme(legend.position = "right") +
geom_line(stat = "smooth", method = "lm", formula = y~x,
size = 1.25) +
theme(legend.title = element_text(size=12)) +  theme(text = element_text(size = 12)) +
guides(color = "none")
ggsave("fig4c_modified.pdf", height = 4.5, width = 5.5)
# Figure 5: Stability & Biotic Mechanisms ####
## VR and stability
VRstab <- ggplot(meanstab_mech, aes(x=mean_classicVR, y=mean_st)) +
geom_smooth(method = "lm", se = FALSE, fullrange = T, color = "black", size = 1.15)+
geom_vline(xintercept = 1, linetype = "dashed") +
geom_errorbar(aes(ymin = mean_st-SE_st, ymax=mean_st+SE_st), width = 0.06) +
geom_errorbarh(aes(xmin = mean_classicVR-SEclassicVR, xmax=mean_classicVR+SEclassicVR), height = 0.1) + #add standard error bars
geom_point(aes(fill=TREATMENT),
colour="black",pch=21, size=3.5) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
ylab("Stability") + xlab("Variance Ratio") +
theme(text = element_text(size = 12))  + #change font sizes
annotate("text", x =1.07, y=3.3, label = "synchronous", size = 4, angle='90', fontface = 'italic') +
annotate("text", x =0.9, y=3.3, label = "asynchronous", size = 4, angle='90',fontface = 'italic') +
theme(legend.position = "none")
## Aggregate dominant sp stability by stability
domspstabst <- ggplot(meanstab_mech, aes(x=avgpopstab, y=mean_st)) +
geom_smooth(method = "lm", se = FALSE, fullrange = T, color = "black", size = 1.15) +
geom_errorbar(aes(ymin = mean_st-SE_st, ymax=mean_st+SE_st), width = 0.06) +
geom_errorbarh(aes(xmin = avgpopstab-SEpopstab, xmax=avgpopstab+SEpopstab), height = 0.1) + #add standard error bars
geom_point(aes(fill=TREATMENT),
colour="black",pch=22, size=3.5) +
scale_fill_scico_d(palette = "batlow", direction = -1) +  ylab("Stability") + xlab("Population Stability") +
theme(text = element_text(size = 12)) + #change font sizes
theme(legend.position = "none")
## richness and stability
prichstab <- ggplot(meanstab_mech, aes(x=mean_rich, y=mean_st)) +
geom_errorbar(aes(ymin = mean_st-SE_st, ymax=mean_st+SE_st), width = 0.2) +
geom_errorbarh(aes(xmin = mean_rich-SE_rich, xmax=mean_rich+SE_rich), height = 0.1) + #add standard error bars
geom_point(aes(fill=TREATMENT),
colour="black",pch=21, size=3.5) +
scale_fill_scico_d(palette = "batlow", direction = -1) +  ylab("Stability") + xlab("Species Richness") +
theme(text = element_text(size = 12))  + #change font sizes
theme(legend.position = "none")
fig5 <- ggarrange(VRstab, domspstabst, prichstab,
ncol = 3, nrow=1,
align = "hv",
labels = "AUTO",
common.legend = FALSE)
## extract the legend from Fig 4 for use in Fig 5
leg <- get_legend(VRtrt +
theme(legend.position = "bottom"))
pdf("figure5.pdf", width = 7.087, height = 3.1, onefile = F)
plot_grid(fig5, leg, rel_heights = c(5.5,1), ncol = 1)
dev.off()
## Modified Fig 5A for Allison ####
ggplot(meanstab_mech, aes(x=mean_classicVR, y=mean_st)) +
geom_smooth(method = "lm", se = FALSE, fullrange = T, color = "black", size = 1.15)+
#geom_vline(xintercept = 1, linetype = "dashed") +
geom_errorbar(aes(ymin = mean_st-SE_st, ymax=mean_st+SE_st), width = 0.06) +
geom_errorbarh(aes(xmin = mean_classicVR-SEclassicVR, xmax=mean_classicVR+SEclassicVR), height = 0.1) + #add standard error bars
geom_point(aes(fill=TREATMENT),
colour="black",pch=21, size=3.5) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
ylab("Stability") + xlab("Variance Ratio") +
theme(text = element_text(size = 12))  + #change font sizes
annotate("text", x =1.07, y=3.3, label = "synchronous", size = 4, angle='90', fontface = 'italic') +
annotate("text", x =0.9, y=3.3, label = "asynchronous", size = 4, angle='90',fontface = 'italic') +
theme(legend.position = "none")
## Modified Fig 5A for Allison ####
ggplot(meanstab_mech, aes(x=mean_classicVR, y=mean_st)) +
geom_smooth(method = "lm", se = FALSE, fullrange = T, color = "black", size = 1.15)+
#geom_vline(xintercept = 1, linetype = "dashed") +
geom_errorbar(aes(ymin = mean_st-SE_st, ymax=mean_st+SE_st), width = 0.06) +
geom_errorbarh(aes(xmin = mean_classicVR-SEclassicVR, xmax=mean_classicVR+SEclassicVR), height = 0.1) + #add standard error bars
geom_point(aes(fill=TREATMENT),
colour="black",pch=21, size=3.5) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
ylab("Stability") + xlab("Variance Ratio") +
theme(text = element_text(size = 12))  + #change font sizes
#annotate("text", x =1.07, y=3.3, label = "synchronous", size = 4, angle='90', fontface = 'italic') +
#annotate("text", x =0.9, y=3.3, label = "asynchronous", size = 4, angle='90',fontface = 'italic') +
theme(legend.position = "none")
## Modified Fig 5A for Allison ####
ggplot(meanstab_mech, aes(x=mean_classicVR, y=mean_st)) +
geom_smooth(method = "lm", se = FALSE, fullrange = T, color = "black", size = 1.15)+
#geom_vline(xintercept = 1, linetype = "dashed") +
geom_errorbar(aes(ymin = mean_st-SE_st, ymax=mean_st+SE_st), width = 0.06) +
geom_errorbarh(aes(xmin = mean_classicVR-SEclassicVR, xmax=mean_classicVR+SEclassicVR), height = 0.1) + #add standard error bars
geom_point(size=3.5) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
ylab("Stability") + xlab("Variance Ratio") +
theme(text = element_text(size = 12))  + #change font sizes
#annotate("text", x =1.07, y=3.3, label = "synchronous", size = 4, angle='90', fontface = 'italic') +
#annotate("text", x =0.9, y=3.3, label = "asynchronous", size = 4, angle='90',fontface = 'italic') +
theme(legend.position = "none")
## Modified Fig 5A for Allison ####
ggplot(meanstab_mech, aes(x=mean_classicVR, y=mean_st)) +
geom_smooth(method = "lm", se = FALSE, fullrange = T, color = "black", size = 1)+
geom_errorbar(aes(ymin = mean_st-SE_st, ymax=mean_st+SE_st), width = 0.06) +
geom_errorbarh(aes(xmin = mean_classicVR-SEclassicVR, xmax=mean_classicVR+SEclassicVR), height = 0.1) + #add standard error bars
geom_point(size=3.5) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
ylab("Stability") + xlab("Variance Ratio") +
theme(text = element_text(size = 12))  + #change font sizes
theme(legend.position = "none")
colnames(meanstab_mech)
ggplot(meanstab_mech, aes(x=mean_classicVR, y=mean_st)) +
geom_smooth(method = "lm", se = FALSE, fullrange = T, color = "black", size = 1)+
geom_errorbar(aes(ymin = mean_st-SE_st, ymax=mean_st+SE_st), width = 0.06) +
geom_errorbarh(aes(xmin = mean_classicVR-SEclassicVR, xmax=mean_classicVR+SEclassicVR), height = 0.1) + #add standard error bars
geom_point(size=3) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
ylab("Stability") + xlab("Variance Ratio") +
theme(text = element_text(size = 12))  + #change font sizes
theme(legend.position = "none")
## Modified Fig 5A for Allison ####
VR_inverse <- meanstab_mech %>%
mutate(inverse_cVR = 1/mean_classicVR)
ggplot(VR_inverse, aes(x=inverse_cVR, y=mean_st)) +
geom_point()
meanstab_mech_inv <- stability_mechanisms %>%
mutate(inv_classicVR = 1/classicVR) %>%
group_by(TREATMENT) %>%
summarise(mean_st = mean(stability),
SE_st = calcSE(stability),
mean_classicVR = mean(classicVR),
mean_inv_cVR = mean(inv_classicVR),
SE_inv_cVR = calcSE(inv_classicVR),
SEclassicVR = calcSE(classicVR),
b5meanclassicVR = mean(b5classicVR),
SEb5classicVR = calcSE(b5classicVR),
SE_dom = calcSE(mean_dom),
mean_dom = mean(mean_dom),
mean_rich = mean(meanrich),
SE_rich = calcSE(meanrich),
mean_vardom = mean(vardom),
SE_vardom = calcSE(vardom),
mean_varrich = mean(varrich),
SE_varrich = calcSE(varrich),
mean_CV = mean(CV),
SE_CV = calcSE(CV),
meanlongVR = mean(longVR),
SElVR = calcSE(longVR),
meanshortVR = mean(shortVR),
SEsVR = calcSE(shortVR),
b5meanlongVR = mean(b5longVR),
SEb5lVR = calcSE(b5longVR),
b5meanshortVR = mean(b5shortVR),
SEb5sVR = calcSE(b5shortVR),
meanCV_dom = mean(CVdom),
SECV_dom = calcSE(CVdom),
meanCV_rich = mean(CVrich),
SECV_rich = calcSE(CVrich),
avgpopstab = mean(meanpopstab),
SEpopstab = calcSE(meanpopstab),
mean_bio = mean(pinhits),
SE_bio = calcSE(pinhits),
mean_var = mean(variance),
SE_var = calcSE(variance)) %>%
mutate(TREATMENT = fct_relevel(TREATMENT, "O", "W", "MW", "C", "WC", "MWC"))
## Modified Fig 5A for Allison ####
ggplot(meanstab_mech_inv, aes(x=mean_inv_cVR, y=mean_st)) +
geom_smooth(method = "lm", se = FALSE, fullrange = T, color = "black", size = 1)+
geom_errorbar(aes(ymin = mean_st-SE_st, ymax=mean_st+SE_st), width = 0.06) +
geom_errorbarh(aes(xmin = mean_inv_cVR-SE_inv_cVR, xmax=mean_inv_cVR+SE_inv_cVR), height = 0.1) + #add standard error bars
geom_point(size=3) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
ylab("Stability") + xlab("Compensation") +
theme(text = element_text(size = 12))  + #change font sizes
theme(legend.position = "none")
ggplot(meanstab_mech_inv, aes(x=mean_inv_cVR, y=mean_st)) +
geom_smooth(method = "lm", se = FALSE, fullrange = T, color = "black", size = 1)+
geom_errorbar(aes(ymin = mean_st-SE_st, ymax=mean_st+SE_st), width = 0.06) +
geom_errorbarh(aes(xmin = mean_inv_cVR-SE_inv_cVR, xmax=mean_inv_cVR+SE_inv_cVR), height = 0.1) + #add standard error bars
geom_point(size=3) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
ylab("Stability") + xlab("Compensation") +
theme(text = element_text(size = 12))  + #change font sizes
theme(legend.position = "none")
## Modified Fig 5A for Allison ####
mod_fig5A <- ggplot(meanstab_mech_inv, aes(x=mean_inv_cVR, y=mean_st)) +
geom_smooth(method = "lm", se = FALSE, fullrange = T, color = "black", size = 1)+
geom_errorbar(aes(ymin = mean_st-SE_st, ymax=mean_st+SE_st), width = 0.06) +
geom_errorbarh(aes(xmin = mean_inv_cVR-SE_inv_cVR, xmax=mean_inv_cVR+SE_inv_cVR), height = 0.1) + #add standard error bars
geom_point(size=3) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
ylab("Stability") + xlab("Compensation") +
theme(text = element_text(size = 12))  + #change font sizes
theme(legend.position = "none")
save(mod_fig5A, file = "mod_fig5A.RData")
save(mod_fig5A, file = "modified_fig5A.RData")
load(modified_fig5A)
load("modified_fig5A")
load("modified_fig5A.RData")
saveRDS(mod_fig5A, file = "modified_fig5A.RDS")
load("modified_fig5A.RData")
View(mod_fig5A)
readRDS("modified_fig5A.RDS")
