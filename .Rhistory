## Supplementary Figures ##
library(tidyverse)
library(scico)
library(ggpubr)
setwd("~/Repositories/klee-stability")
source("current_scripts/finalprep_postcalcs.R") ## read in data
theme_set(theme_classic()) #set the theme
## Figure S2: Moving-window Time-Scale
## Stability by Timescale
stabts <- ggplot(mean_mwstab, aes(x = window_size, y=mean_stab)) +
geom_point(size = 3) +
ylab("Mean Stability") + xlab("Window Size of Stability Calculation") +
geom_errorbar(aes(ymin=mean_stab-SE_stab, ymax = mean_stab+SE_stab), width = 0.2) +
geom_point(aes(fill=TREATMENT),
colour="black",pch=21, size=3.5) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
labs(fill = "Treatment")
## Variance Ratio by Timescale
cvrts <- ggplot(mean_mwcVR, aes(x = window_size, y=mean_cVR)) +
geom_point(size = 3) +
ylab("Mean Variance Ratio") + xlab("Window Size of VR Calculation") +
geom_errorbar(aes(ymin=mean_cVR-SE_cVR, ymax = mean_cVR+SE_cVR), width = 0.2) +
geom_point(aes(fill=TREATMENT),
colour="black",pch=21, size=3.5) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
labs(fill = "Treatment")
## Richness by Timescale
richts <- ggplot(mean_mwrich, aes(x=window_size, y=mean_rich)) +
geom_point(size=3) +
ylab("Mean Richness") + xlab("Window Size of Richness Calculation") +
geom_errorbar(aes(ymin=mean_rich-SE_rich, ymax = mean_rich+SE_rich), width = 0.2) +
geom_point(aes(fill=TREATMENT),
colour="black",pch=21, size=3.5) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
labs(fill = "Treatment")
popstts <- ggplot(mean_mwpopst, aes(x=window_size, y=mean_popst)) +
geom_point(size=3) +
ylab("Mean Dom Pop Stability") + xlab("Window Size of Pop Stability Calculation") +
geom_errorbar(aes(ymin=mean_popst-SE_popst, ymax = mean_popst+SE_popst), width = 0.2) +
geom_point(aes(fill=TREATMENT),
colour="black",pch=21, size=3.5) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
labs(fill = "Treatment")
ggarrange(stabts, cvrts, richts, popstts,
ncol=2, nrow = 2, align = "hv",
common.legend = TRUE,
labels = "AUTO",
legend = "bottom")
stabts <- ggplot(mean_mwstab, aes(x = window_size, y=mean_stab)) +
geom_point(size = 2) +
ylab("Mean Stability") + xlab("Window Size of Stability Calculation") +
geom_errorbar(aes(ymin=mean_stab-SE_stab, ymax = mean_stab+SE_stab), width = 0.2) +
geom_point(aes(fill=TREATMENT),
colour="black",pch=21, size=3.5) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
labs(fill = "Treatment")
## Variance Ratio by Timescale
cvrts <- ggplot(mean_mwcVR, aes(x = window_size, y=mean_cVR)) +
geom_point(size = 2) +
ylab("Mean Variance Ratio") + xlab("Window Size of VR Calculation") +
geom_errorbar(aes(ymin=mean_cVR-SE_cVR, ymax = mean_cVR+SE_cVR), width = 0.2) +
geom_point(aes(fill=TREATMENT),
colour="black",pch=21, size=3.5) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
labs(fill = "Treatment")
## Richness by Timescale
richts <- ggplot(mean_mwrich, aes(x=window_size, y=mean_rich)) +
geom_point(size=2) +
ylab("Mean Richness") + xlab("Window Size of Richness Calculation") +
geom_errorbar(aes(ymin=mean_rich-SE_rich, ymax = mean_rich+SE_rich), width = 0.2) +
geom_point(aes(fill=TREATMENT),
colour="black",pch=21, size=3.5) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
labs(fill = "Treatment")
## Dominant Species Stability by Timescale
popstts <- ggplot(mean_mwpopst, aes(x=window_size, y=mean_popst)) +
geom_point(size=2) +
ylab("Mean Dom Pop Stability") + xlab("Window Size of Pop Stability Calculation") +
geom_errorbar(aes(ymin=mean_popst-SE_popst, ymax = mean_popst+SE_popst), width = 0.2) +
geom_point(aes(fill=TREATMENT),
colour="black",pch=21, size=3.5) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
labs(fill = "Treatment")
ggarrange(stabts, cvrts, richts, popstts,
ncol=2, nrow = 2, align = "hv",
common.legend = TRUE,
labels = "AUTO",
legend = "bottom")
View(mean_mwcVR)
meancrv <- mean_mwcVR %>%
group_by(TREATMENT, window_size) %>%
summarise(mean_vr = mean(mean_cVR), se_vr = calcSE(mean_cVR))
ggplot(meancrv, aes(x = window_size, y=mean_cVR)) +
geom_point(size = 2) +
ylab("Mean Variance Ratio") + xlab("Window Size of VR Calculation") +
geom_errorbar(aes(ymin=mean_cVR-SE_cVR, ymax = mean_cVR+SE_cVR), width = 0.2) +
geom_point(aes(fill=TREATMENT),
colour="black",pch=21, size=3.5) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
labs(fill = "Treatment")
ggplot(meancrv, aes(x = window_size, y=mean_vr)) +
geom_point(size = 2) +
ylab("Mean Variance Ratio") + xlab("Window Size of VR Calculation") +
geom_errorbar(aes(ymin=mean_vr-se_vr, ymax = mean_vr+se_vr), width = 0.2) +
geom_point(aes(fill=TREATMENT),
colour="black",pch=21, size=3.5) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
labs(fill = "Treatment")
## Variance Ratio by Timescale
cvrts <- ggplot(meancrv, aes(x = window_size, y=mean_vr)) +
geom_point(size = 2) +
ylab("Mean Variance Ratio") + xlab("Window Size of VR Calculation") +
geom_errorbar(aes(ymin=mean_vr-se_vr, ymax = mean_vr+se_vr), width = 0.2) +
geom_point(aes(fill=TREATMENT),
colour="black",pch=21, size=3.5) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
labs(fill = "Treatment")
meanri <- mean_mwrich %>%
group_by(TREATMENT, window_size) %>%
summarise(mean_ri = mean(mean_rich), se_ri = calcSE(mean_rich))
ggplot(meanri, aes(x=window_size, y=mean_ri)) +
geom_point(size=2) +
ylab("Mean Richness") + xlab("Window Size of Richness Calculation") +
geom_errorbar(aes(ymin=mean_ri-se_ri, ymax = mean_ri+se_ri), width = 0.2) +
geom_point(aes(fill=TREATMENT),
colour="black",pch=21, size=3.5) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
labs(fill = "Treatment")
meancrv <- mean_mwcVR %>%
group_by(TREATMENT, window_size) %>%
summarise(mean_vr = mean(mean_cVR), se_vr = calcSE(mean_cVR)) %>%
mutate(TREATMENT = fct_relevel(TREATMENT, "O", "W", "MW", "C", "WC", "MWC")) #reorder treatments
mean_mwcVR$TREATMENT <- as.factor(mean_mwcVR$TREATMENT)
meancrv <- mean_mwcVR %>%
group_by(TREATMENT, window_size) %>%
summarise(mean_vr = mean(mean_cVR), se_vr = calcSE(mean_cVR)) %>%
mutate(TREATMENT = fct_relevel(TREATMENT, "O", "W", "MW", "C", "WC", "MWC")) #reorder treatments
mean_mwrich$TREATMENT <- as.factor(mean_mwrich$TREATMENT)
meanri <- mean_mwrich %>%
group_by(TREATMENT, window_size) %>%
summarise(mean_ri = mean(mean_rich), se_ri = calcSE(mean_rich)) %>%
mutate(TREATMENT = fct_relevel(TREATMENT, "O", "W", "MW", "C", "WC", "MWC")) #reorder treatments
## Stability by Timescale
stabts <- ggplot(mean_mwstab, aes(x = window_size, y=mean_stab)) +
geom_point(size = 2) +
ylab("Mean Stability") + xlab("Window Size of Stability Calculation") +
geom_errorbar(aes(ymin=mean_stab-SE_stab, ymax = mean_stab+SE_stab), width = 0.2) +
geom_point(aes(fill=TREATMENT),
colour="black",pch=21, size=3.5) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
labs(fill = "Treatment")
mean_mwcVR$TREATMENT <- as.factor(mean_mwcVR$TREATMENT)
meancrv <- mean_mwcVR %>%
group_by(TREATMENT, window_size) %>%
summarise(mean_vr = mean(mean_cVR), se_vr = calcSE(mean_cVR)) %>%
mutate(TREATMENT = fct_relevel(TREATMENT, "O", "W", "MW", "C", "WC", "MWC")) #reorder treatments
## Variance Ratio by Timescale
cvrts <- ggplot(meancrv, aes(x = window_size, y=mean_vr)) +
geom_point(size = 2) +
ylab("Mean Variance Ratio") + xlab("Window Size of VR Calculation") +
geom_errorbar(aes(ymin=mean_vr-se_vr, ymax = mean_vr+se_vr), width = 0.2) +
geom_point(aes(fill=TREATMENT),
colour="black",pch=21, size=3.5) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
labs(fill = "Treatment")
mean_mwrich$TREATMENT <- as.factor(mean_mwrich$TREATMENT)
meanri <- mean_mwrich %>%
group_by(TREATMENT, window_size) %>%
summarise(mean_ri = mean(mean_rich), se_ri = calcSE(mean_rich)) %>%
mutate(TREATMENT = fct_relevel(TREATMENT, "O", "W", "MW", "C", "WC", "MWC")) #reorder treatments
## Richness by Timescale
richts <- ggplot(meanri, aes(x=window_size, y=mean_ri)) +
geom_point(size=2) +
ylab("Mean Richness") + xlab("Window Size of Richness Calculation") +
geom_errorbar(aes(ymin=mean_ri-se_ri, ymax = mean_ri+se_ri), width = 0.2) +
geom_point(aes(fill=TREATMENT),
colour="black",pch=21, size=3.5) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
labs(fill = "Treatment")
## Dominant Species Stability by Timescale
popstts <- ggplot(mean_mwpopst, aes(x=window_size, y=mean_popst)) +
geom_point(size=2) +
ylab("Mean Dom Pop Stability") + xlab("Window Size of Pop Stability Calculation") +
geom_errorbar(aes(ymin=mean_popst-SE_popst, ymax = mean_popst+SE_popst), width = 0.2) +
geom_point(aes(fill=TREATMENT),
colour="black",pch=21, size=3.5) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
labs(fill = "Treatment")
ggarrange(stabts, cvrts, richts, popstts,
ncol=2, nrow = 2, align = "hv",
common.legend = TRUE,
labels = "AUTO",
legend = "bottom")
mean_mwstab$TREATMENT <- as.factor(mean_mwstab$TREATMENT)
mean_mwstab$TREATMENT <- as.factor(mean_mwstab$TREATMENT)
mean_mwstab <- mean_mwstab %>%
mutate(TREATMENT = fct_relevel(TREATMENT, "O", "W", "MW", "C", "WC", "MWC")) #reorder treatments
## Stability by Timescale
stabts <- ggplot(mean_mwstab, aes(x = window_size, y=mean_stab)) +
geom_point(size = 2) +
ylab("Mean Stability") + xlab("Window Size of Stability Calculation") +
geom_errorbar(aes(ymin=mean_stab-SE_stab, ymax = mean_stab+SE_stab), width = 0.2) +
geom_point(aes(fill=TREATMENT),
colour="black",pch=21, size=3.5) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
labs(fill = "Treatment")
mean_mwpopst$TREATMENT <- as.factor(mean_mwpopst$TREATMENT)
mean_mwpopst <- mean_mwpopst %>%
mutate(TREATMENT = fct_relevel(TREATMENT, "O", "W", "MW", "C", "WC", "MWC")) #reorder treatments
popstts <- ggplot(mean_mwpopst, aes(x=window_size, y=mean_popst)) +
geom_point(size=2) +
ylab("Mean Dom Pop Stability") + xlab("Window Size of Pop Stability Calculation") +
geom_errorbar(aes(ymin=mean_popst-SE_popst, ymax = mean_popst+SE_popst), width = 0.2) +
geom_point(aes(fill=TREATMENT),
colour="black",pch=21, size=3.5) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
labs(fill = "Treatment")
popstts <- ggplot(mean_mwpopst, aes(x=window_size, y=mean_popst)) +
geom_point(size=1.5) +
ylab("Mean Dom Pop Stability") + xlab("Window Size of Pop Stability Calculation") +
geom_errorbar(aes(ymin=mean_popst-SE_popst, ymax = mean_popst+SE_popst), width = 0.2) +
geom_point(aes(fill=TREATMENT),
colour="black",pch=21, size=3.5) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
labs(fill = "Treatment")
## Richness by Timescale
richts <- ggplot(meanri, aes(x=window_size, y=mean_ri)) +
geom_point(size=1.5) +
ylab("Mean Richness") + xlab("Window Size of Richness Calculation") +
geom_errorbar(aes(ymin=mean_ri-se_ri, ymax = mean_ri+se_ri), width = 0.2) +
geom_point(aes(fill=TREATMENT),
colour="black",pch=21, size=3.5) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
labs(fill = "Treatment")
## Variance Ratio by Timescale
cvrts <- ggplot(meancrv, aes(x = window_size, y=mean_vr)) +
geom_point(size = 1.5) +
ylab("Mean Variance Ratio") + xlab("Window Size of VR Calculation") +
geom_errorbar(aes(ymin=mean_vr-se_vr, ymax = mean_vr+se_vr), width = 0.2) +
geom_point(aes(fill=TREATMENT),
colour="black",pch=21, size=3.5) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
labs(fill = "Treatment")
## Stability by Timescale
stabts <- ggplot(mean_mwstab, aes(x = window_size, y=mean_stab)) +
geom_point(size = 1.5) +
ylab("Mean Stability") + xlab("Window Size of Stability Calculation") +
geom_errorbar(aes(ymin=mean_stab-SE_stab, ymax = mean_stab+SE_stab), width = 0.2) +
geom_point(aes(fill=TREATMENT),
colour="black",pch=21, size=3.5) +
scale_fill_scico_d(palette = "batlow", direction = -1) +
labs(fill = "Treatment")
ggarrange(stabts, cvrts, richts, popstts,
ncol=2, nrow = 2, align = "hv",
common.legend = TRUE,
labels = "AUTO",
legend = "bottom")
